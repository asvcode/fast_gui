---

title: Code

keywords: fastai
sidebar: home_sidebar

summary: "Code writing tab of GUI"
description: "Code writing tab of GUI"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 05_code.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">write_code</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Helper for writing code&quot;&quot;&quot;</span>
    <span class="n">write_button</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s1">&#39;Code&#39;</span><span class="p">,</span> <span class="n">button_style</span> <span class="o">=</span> <span class="s1">&#39;success&#39;</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">write_button</span><span class="p">)</span>
    <span class="n">write_out</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Output</span><span class="p">()</span>
    <span class="n">display</span><span class="p">(</span><span class="n">write_out</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">on_write_button</span><span class="p">(</span><span class="n">b</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">write_out</span><span class="p">:</span>
            <span class="n">clear_output</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">RED</span> <span class="o">+</span> <span class="n">BOLD</span> <span class="o">+</span> <span class="s1">&#39;&quot;&quot;&quot;import libraries&quot;&quot;&quot;&#39;</span> <span class="o">+</span> <span class="n">RESET</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">GREEN</span> <span class="o">+</span> <span class="n">BOLD</span> <span class="o">+</span> <span class="s1">&#39;from&#39;</span> <span class="o">+</span> <span class="n">RESET</span> <span class="o">+</span> <span class="s1">&#39; fastai2.vision.all &#39;</span> <span class="o">+</span> <span class="n">GREEN</span> <span class="o">+</span> <span class="n">BOLD</span> <span class="o">+</span> <span class="s1">&#39;import*&#39;</span> <span class="o">+</span> <span class="n">RESET</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">RED</span> <span class="o">+</span> <span class="n">BOLD</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&quot;&quot;&quot;get data source and image files from source&quot;&quot;&quot;&#39;</span> <span class="o">+</span> <span class="n">RESET</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;source = untar_data(URLs.&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">dashboard_two</span><span class="o">.</span><span class="n">datas</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;items = get_image_files(source)&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">RED</span> <span class="o">+</span> <span class="n">BOLD</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&quot;&quot;&quot;get item, split and batch transforms&quot;&quot;&quot;&#39;</span> <span class="o">+</span> <span class="n">RESET</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;tfms = [[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">block_ch</span><span class="o">.</span><span class="n">code</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;]&#39;</span> <span class="o">+</span> <span class="s1">&#39; ,&#39;</span> <span class="o">+</span> <span class="s1">&#39;[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">block_ch</span><span class="o">.</span><span class="n">outputb_code</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span>
                  <span class="o">+</span>  <span class="nb">str</span><span class="p">(</span><span class="n">block_ch</span><span class="o">.</span><span class="n">ctg_code</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;]]&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;item_tfms = [ToTensor(), Resize(&#39;</span> <span class="o">+</span> <span class="n">GREEN</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">aug_dash</span><span class="o">.</span><span class="n">imgsiz</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="o">+</span> <span class="n">RESET</span> <span class="o">+</span> <span class="s1">&#39;)]&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;split_idx = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">block_ch</span><span class="o">.</span><span class="n">spl_val_code</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;(items)&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">RED</span> <span class="o">+</span> <span class="n">BOLD</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&quot;&quot;&quot;image augmentations&quot;&quot;&quot;&#39;</span> <span class="o">+</span> <span class="n">RESET</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">aug_dash</span><span class="o">.</span><span class="n">aug</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="s1">&#39;No&#39;</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;xtra_tfms = &#39;</span><span class="o">+</span> <span class="n">GREEN</span> <span class="o">+</span> <span class="n">BOLD</span> <span class="o">+</span> <span class="s1">&#39;None&#39;</span> <span class="o">+</span> <span class="n">RESET</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">aug_dash</span><span class="o">.</span><span class="n">aug</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="s1">&#39;Yes&#39;</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">RESET</span> <span class="o">+</span> <span class="s1">&#39;xtra_tfms = [RandomErasing(p=&#39;</span> <span class="o">+</span> <span class="n">GREEN</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">aug</span><span class="o">.</span><span class="n">b_pval</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="o">+</span> <span class="n">RESET</span> <span class="o">+</span> <span class="s1">&#39;, max_count=&#39;</span> <span class="o">+</span>
                     <span class="n">GREEN</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">aug</span><span class="o">.</span><span class="n">b_max</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="o">+</span> <span class="n">RESET</span> <span class="o">+</span> <span class="s1">&#39;, min_aspect=&#39;</span> <span class="o">+</span> <span class="n">GREEN</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">aug</span><span class="o">.</span><span class="n">b_asp</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="o">+</span> <span class="n">RESET</span> <span class="o">+</span> <span class="s1">&#39;, sl=&#39;</span> <span class="o">+</span>
                     <span class="n">GREEN</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">aug</span><span class="o">.</span><span class="n">b_len</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="o">+</span> <span class="n">RESET</span> <span class="o">+</span>  <span class="s1">&#39;, sh=&#39;</span> <span class="o">+</span> <span class="n">RESET</span> <span class="o">+</span> <span class="n">GREEN</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">aug</span><span class="o">.</span><span class="n">b_ht</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="o">+</span> <span class="n">RESET</span> <span class="o">+</span> <span class="s1">&#39;),&#39;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">RESET</span> <span class="o">+</span> <span class="s1">&#39;             Brightness(max_lighting=&#39;</span> <span class="o">+</span> <span class="n">GREEN</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">aug</span><span class="o">.</span><span class="n">b4_max</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="o">+</span>  <span class="n">RESET</span>  <span class="o">+</span> <span class="s1">&#39;, p=&#39;</span> <span class="o">+</span> <span class="n">GREEN</span> <span class="o">+</span>
                      <span class="nb">str</span><span class="p">(</span><span class="n">aug</span><span class="o">.</span><span class="n">b4_pval</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="o">+</span> <span class="n">RESET</span> <span class="o">+</span> <span class="s1">&#39;, draw=&#39;</span> <span class="o">+</span> <span class="n">GREEN</span> <span class="o">+</span> <span class="n">BOLD</span> <span class="o">+</span> <span class="s1">&#39;None&#39;</span> <span class="o">+</span> <span class="n">RESET</span> <span class="o">+</span> <span class="s1">&#39;, batch=&#39;</span> <span class="o">+</span> <span class="n">GREEN</span> <span class="o">+</span> <span class="n">BOLD</span> <span class="o">+</span> <span class="s1">&#39;None&#39;</span> <span class="o">+</span>
                      <span class="n">RESET</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">RESET</span> <span class="o">+</span> <span class="s1">&#39;             Rotate(max_deg=&#39;</span> <span class="o">+</span> <span class="n">GREEN</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">aug</span><span class="o">.</span><span class="n">b2_max</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="o">+</span>  <span class="n">RESET</span>  <span class="o">+</span> <span class="s1">&#39;, p=&#39;</span> <span class="o">+</span> <span class="n">GREEN</span> <span class="o">+</span>
                      <span class="nb">str</span><span class="p">(</span><span class="n">aug</span><span class="o">.</span><span class="n">b2_pval</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="o">+</span> <span class="n">RESET</span> <span class="o">+</span> <span class="s1">&#39;, draw=&#39;</span> <span class="o">+</span> <span class="n">GREEN</span> <span class="o">+</span> <span class="n">BOLD</span> <span class="o">+</span> <span class="s1">&#39;None&#39;</span> <span class="o">+</span> <span class="n">RESET</span> <span class="o">+</span> <span class="s1">&#39;, size=&#39;</span> <span class="o">+</span> <span class="n">GREEN</span> <span class="o">+</span> <span class="n">BOLD</span> <span class="o">+</span> <span class="s1">&#39;None&#39;</span> <span class="o">+</span>
                      <span class="n">RESET</span> <span class="o">+</span> <span class="s1">&#39;, mode=&#39;</span> <span class="o">+</span> <span class="n">RED</span> <span class="o">+</span> <span class="s2">&quot;&#39;bilinear&#39;&quot;</span> <span class="o">+</span> <span class="n">RESET</span> <span class="o">+</span> <span class="s1">&#39;, pad_mode=&#39;</span> <span class="o">+</span> <span class="n">RED</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">aug_dash</span><span class="o">.</span><span class="n">pad</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="o">+</span> <span class="n">RESET</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">RESET</span> <span class="o">+</span> <span class="s1">&#39;             Warp(magnitude=&#39;</span> <span class="o">+</span> <span class="n">GREEN</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">aug</span><span class="o">.</span><span class="n">b3_mag</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="o">+</span>  <span class="n">RESET</span>  <span class="o">+</span> <span class="s1">&#39;, p=&#39;</span> <span class="o">+</span> <span class="n">GREEN</span> <span class="o">+</span>
                      <span class="nb">str</span><span class="p">(</span><span class="n">aug</span><span class="o">.</span><span class="n">b3_pval</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="o">+</span> <span class="n">RESET</span> <span class="o">+</span> <span class="s1">&#39;, draw_x=&#39;</span> <span class="o">+</span> <span class="n">GREEN</span> <span class="o">+</span> <span class="n">BOLD</span> <span class="o">+</span> <span class="s1">&#39;None&#39;</span> <span class="o">+</span> <span class="n">RESET</span> <span class="o">+</span> <span class="s1">&#39;, draw_y=&#39;</span> <span class="o">+</span> <span class="n">GREEN</span> <span class="o">+</span> <span class="n">BOLD</span> <span class="o">+</span>
                      <span class="s1">&#39;None&#39;</span> <span class="o">+</span>  <span class="n">RESET</span> <span class="o">+</span> <span class="s1">&#39;, size=&#39;</span> <span class="o">+</span> <span class="n">GREEN</span> <span class="o">+</span> <span class="n">BOLD</span> <span class="o">+</span> <span class="s1">&#39;None&#39;</span> <span class="o">+</span> <span class="n">RESET</span> <span class="o">+</span> <span class="s1">&#39;, mode=&#39;</span> <span class="o">+</span> <span class="n">RED</span> <span class="o">+</span> <span class="s2">&quot;&#39;bilinear&#39;&quot;</span> <span class="o">+</span> <span class="n">RESET</span> <span class="o">+</span> <span class="s1">&#39;, pad_mode=&#39;</span> <span class="o">+</span>
                      <span class="n">RED</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">aug_dash</span><span class="o">.</span><span class="n">pad</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="o">+</span> <span class="n">RESET</span> <span class="o">+</span> <span class="s1">&#39;, batch=&#39;</span> <span class="o">+</span> <span class="n">GREEN</span> <span class="o">+</span> <span class="n">BOLD</span> <span class="o">+</span> <span class="s1">&#39;False&#39;</span> <span class="o">+</span> <span class="n">RESET</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">RESET</span> <span class="o">+</span> <span class="s1">&#39;             Contrast(max_lighting=&#39;</span> <span class="o">+</span> <span class="n">GREEN</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">aug</span><span class="o">.</span><span class="n">b1_max</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="o">+</span>  <span class="n">RESET</span>  <span class="o">+</span> <span class="s1">&#39;, p=&#39;</span> <span class="o">+</span> <span class="n">GREEN</span> <span class="o">+</span>
                      <span class="nb">str</span><span class="p">(</span><span class="n">aug</span><span class="o">.</span><span class="n">b1_pval</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="o">+</span> <span class="n">RESET</span> <span class="o">+</span> <span class="s1">&#39;, draw=&#39;</span> <span class="o">+</span> <span class="n">GREEN</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">aug</span><span class="o">.</span><span class="n">b1_draw</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="o">+</span> <span class="n">RESET</span> <span class="o">+</span> <span class="s1">&#39;, batch=&#39;</span> <span class="o">+</span> <span class="n">GREEN</span> <span class="o">+</span> <span class="n">BOLD</span> <span class="o">+</span>
                      <span class="s1">&#39;True&#39;</span> <span class="o">+</span> <span class="n">RESET</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">RESET</span> <span class="o">+</span> <span class="s1">&#39;             Dihedral(p=&#39;</span> <span class="o">+</span> <span class="n">GREEN</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">aug</span><span class="o">.</span><span class="n">b5_pval</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="o">+</span>  <span class="n">RESET</span>  <span class="o">+</span> <span class="s1">&#39;, draw&#39;</span> <span class="o">+</span> <span class="n">GREEN</span> <span class="o">+</span>
                      <span class="nb">str</span><span class="p">(</span><span class="n">aug</span><span class="o">.</span><span class="n">b5_draw</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="o">+</span> <span class="n">RESET</span> <span class="o">+</span> <span class="s1">&#39;, size=&#39;</span> <span class="o">+</span> <span class="n">GREEN</span> <span class="o">+</span> <span class="n">BOLD</span> <span class="o">+</span> <span class="s1">&#39;None&#39;</span> <span class="o">+</span> <span class="n">RESET</span> <span class="o">+</span> <span class="s1">&#39;, mode=&#39;</span> <span class="o">+</span> <span class="n">RED</span> <span class="o">+</span> <span class="s2">&quot;&#39;bilinear&#39;&quot;</span> <span class="o">+</span> <span class="n">RESET</span> <span class="o">+</span>
                      <span class="s1">&#39;, pad_mode=&#39;</span> <span class="o">+</span> <span class="n">RED</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">aug_dash</span><span class="o">.</span><span class="n">pad</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="o">+</span> <span class="n">RESET</span> <span class="o">+</span> <span class="s1">&#39;, batch=&#39;</span> <span class="o">+</span> <span class="n">GREEN</span> <span class="o">+</span> <span class="n">BOLD</span> <span class="o">+</span> <span class="s1">&#39;False&#39;</span> <span class="o">+</span> <span class="n">RESET</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">RESET</span> <span class="o">+</span> <span class="s1">&#39;             Zoom(max_zoom=&#39;</span> <span class="o">+</span> <span class="n">GREEN</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">aug</span><span class="o">.</span><span class="n">b6_zoom</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="o">+</span>  <span class="n">RESET</span>  <span class="o">+</span> <span class="s1">&#39;, p=&#39;</span> <span class="o">+</span> <span class="n">GREEN</span> <span class="o">+</span>
                      <span class="nb">str</span><span class="p">(</span><span class="n">aug</span><span class="o">.</span><span class="n">b6_pval</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="o">+</span> <span class="n">RESET</span> <span class="o">+</span> <span class="s1">&#39;, draw=&#39;</span> <span class="o">+</span> <span class="n">GREEN</span> <span class="o">+</span> <span class="n">BOLD</span> <span class="o">+</span> <span class="s1">&#39;None&#39;</span> <span class="o">+</span> <span class="n">RESET</span> <span class="o">+</span> <span class="s1">&#39;, draw_x=&#39;</span> <span class="o">+</span> <span class="n">GREEN</span> <span class="o">+</span> <span class="n">BOLD</span> <span class="o">+</span> <span class="s1">&#39;None&#39;</span> <span class="o">+</span> <span class="n">RESET</span> <span class="o">+</span>
                      <span class="s1">&#39;, draw_y=&#39;</span> <span class="o">+</span> <span class="n">GREEN</span> <span class="o">+</span> <span class="n">BOLD</span> <span class="o">+</span> <span class="s1">&#39;None&#39;</span> <span class="o">+</span>  <span class="n">RESET</span> <span class="o">+</span> <span class="s1">&#39;, size=&#39;</span> <span class="o">+</span> <span class="n">GREEN</span> <span class="o">+</span> <span class="n">BOLD</span> <span class="o">+</span> <span class="s1">&#39;None&#39;</span> <span class="o">+</span> <span class="n">RESET</span> <span class="o">+</span> <span class="s1">&#39;, mode=&#39;</span> <span class="o">+</span> <span class="n">RED</span> <span class="o">+</span> <span class="s2">&quot;&#39;bilinear&#39;&quot;</span> <span class="o">+</span>
                      <span class="n">RESET</span> <span class="o">+</span> <span class="s1">&#39;, pad_mode=&#39;</span> <span class="o">+</span> <span class="n">RED</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">aug_dash</span><span class="o">.</span><span class="n">pad</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="o">+</span> <span class="n">RESET</span> <span class="o">+</span> <span class="s1">&#39;, batch=&#39;</span> <span class="o">+</span> <span class="n">GREEN</span> <span class="o">+</span> <span class="n">BOLD</span> <span class="o">+</span> <span class="s1">&#39;False&#39;</span> <span class="o">+</span> <span class="n">RESET</span> <span class="o">+</span> <span class="s1">&#39;)]&#39;</span><span class="p">)</span>

            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">after_b = [Resize(&#39;</span> <span class="o">+</span> <span class="n">GREEN</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">aug_dash</span><span class="o">.</span><span class="n">imgbth</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="o">+</span> <span class="n">RESET</span> <span class="o">+</span> <span class="s1">&#39;), IntToFloatTensor(), &#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">          &#39;</span> <span class="o">+</span> <span class="s2">&quot;*aug_transforms(xtra_tfms=xtra_tfms, pad_mode=&quot;</span>
                  <span class="o">+</span> <span class="n">RED</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">aug_dash</span><span class="o">.</span><span class="n">pad</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="n">RESET</span> <span class="o">+</span> <span class="s1">&#39;),&#39;</span> <span class="o">+</span> <span class="s1">&#39; Normalize.from_stats(&#39;</span> <span class="o">+</span> <span class="n">GREEN</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">stats_info</span><span class="o">.</span><span class="n">code</span><span class="p">)</span> <span class="o">+</span> <span class="n">RESET</span> <span class="o">+</span> <span class="s1">&#39;)]&#39;</span><span class="p">)</span>

            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">dsets = Datasets(items, tfms=tfms, splits=split_idx)&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;dls = dsets.dataloaders(after_item=item_tfms, after_batch=after_b, bs=&#39;</span> <span class="o">+</span> <span class="n">GREEN</span> <span class="o">+</span> <span class="p">(</span><span class="n">aug_dash</span><span class="o">.</span><span class="n">bs</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="o">+</span> <span class="n">RESET</span> <span class="o">+</span>
                  <span class="s1">&#39;, num_workers=&#39;</span> <span class="o">+</span> <span class="n">GREEN</span> <span class="o">+</span> <span class="s1">&#39;0&#39;</span> <span class="o">+</span> <span class="n">RESET</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">)</span>


            <span class="nb">print</span><span class="p">(</span><span class="n">RED</span> <span class="o">+</span> <span class="n">BOLD</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&quot;&quot;&quot;Check training and valid shapes&quot;&quot;&quot;&#39;</span> <span class="o">+</span> <span class="n">RESET</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;xb, yb = dls.one_batch()&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">RESET</span> <span class="o">+</span> <span class="s1">&#39;dls.train&#39;</span> <span class="o">+</span> <span class="n">RESET</span> <span class="o">+</span> <span class="n">RED</span> <span class="o">+</span> <span class="n">BOLD</span> <span class="o">+</span> <span class="s1">&#39; #train&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">RESET</span> <span class="o">+</span> <span class="s1">&#39;dls.train_ds&#39;</span> <span class="o">+</span> <span class="n">RESET</span> <span class="o">+</span> <span class="n">RED</span> <span class="o">+</span> <span class="n">BOLD</span> <span class="o">+</span> <span class="s1">&#39;#train_ds&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">RESET</span> <span class="o">+</span> <span class="s1">&#39;dls.valid&#39;</span> <span class="o">+</span> <span class="n">RESET</span> <span class="o">+</span> <span class="n">RED</span> <span class="o">+</span> <span class="n">BOLD</span> <span class="o">+</span> <span class="s1">&#39; #valid&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">RESET</span> <span class="o">+</span> <span class="s1">&#39;dls.valid_ds&#39;</span> <span class="o">+</span> <span class="n">RESET</span> <span class="o">+</span> <span class="n">RED</span> <span class="o">+</span> <span class="n">BOLD</span> <span class="o">+</span> <span class="s1">&#39; #valid_ds&#39;</span><span class="p">)</span>

            <span class="nb">print</span><span class="p">(</span><span class="n">RESET</span> <span class="o">+</span> <span class="n">RED</span> <span class="o">+</span> <span class="n">BOLD</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&quot;&quot;&quot;show batch&quot;&quot;&quot;&#39;</span> <span class="o">+</span> <span class="n">RESET</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;dls.show_batch(max_n=&#39;</span> <span class="o">+</span> <span class="n">GREEN</span> <span class="o">+</span> <span class="s1">&#39;12&#39;</span> <span class="o">+</span> <span class="n">RESET</span> <span class="o">+</span> <span class="s1">&#39;, rows=&#39;</span> <span class="o">+</span> <span class="n">GREEN</span> <span class="o">+</span> <span class="s1">&#39;2&#39;</span> <span class="o">+</span> <span class="n">RESET</span> <span class="o">+</span> <span class="s1">&#39;, cols=&#39;</span> <span class="o">+</span>
                  <span class="n">GREEN</span>  <span class="o">+</span> <span class="s1">&#39;6&#39;</span> <span class="o">+</span> <span class="n">RESET</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">RESET</span> <span class="o">+</span> <span class="n">RED</span> <span class="o">+</span> <span class="n">BOLD</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&quot;&quot;&quot;train&quot;&quot;&quot;&#39;</span> <span class="o">+</span> <span class="n">RESET</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;arch = xresnet50(pretrained=&#39;</span> <span class="o">+</span> <span class="n">GREEN</span> <span class="o">+</span> <span class="n">BOLD</span> <span class="o">+</span> <span class="s1">&#39;False&#39;</span> <span class="o">+</span> <span class="n">RESET</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;learn = Learner(dls, model=arch, loss_function=LabelSmoothingCrossEntropy(),&#39;</span> <span class="o">+</span>
                 <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">                metrics=[top_k_accuracy, accuracy])&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">RESET</span> <span class="o">+</span> <span class="s1">&#39;learn.fit_one_cycle(&#39;</span> <span class="o">+</span> <span class="n">GREEN</span> <span class="o">+</span> <span class="s1">&#39;1&#39;</span> <span class="o">+</span> <span class="n">RESET</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="n">GREEN</span> <span class="o">+</span> <span class="s1">&#39;1e-2&#39;</span> <span class="o">+</span> <span class="n">RESET</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">RESET</span> <span class="o">+</span> <span class="n">RED</span> <span class="o">+</span> <span class="n">BOLD</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&quot;&quot;&quot;interpretations&quot;&quot;&quot;&#39;</span> <span class="o">+</span> <span class="n">RESET</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;interp = ClassificationInterpretation.from_learner(learn)&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;losses, idxs = interp.top_losses()&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">GREEN</span> <span class="o">+</span> <span class="s1">&#39;len&#39;</span> <span class="o">+</span> <span class="n">RESET</span> <span class="o">+</span> <span class="s1">&#39;(dls.valid_ds)&#39;</span> <span class="o">+</span> <span class="n">RESET</span> <span class="o">+</span> <span class="s1">&#39;==&#39;</span> <span class="o">+</span> <span class="n">GREEN</span> <span class="o">+</span> <span class="s1">&#39;len&#39;</span> <span class="o">+</span> <span class="n">RESET</span> <span class="o">+</span> <span class="s1">&#39;(losses)==&#39;</span> <span class="o">+</span>
                 <span class="n">GREEN</span> <span class="o">+</span> <span class="s1">&#39;len&#39;</span> <span class="o">+</span> <span class="n">RESET</span> <span class="o">+</span> <span class="s1">&#39;(idxs)&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">RESET</span> <span class="o">+</span> <span class="n">RED</span> <span class="o">+</span> <span class="n">BOLD</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&quot;&quot;&quot;confusion matrix&quot;&quot;&quot;&#39;</span> <span class="o">+</span> <span class="n">RESET</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;interp.plot_confusion_matrix(figsize=(&#39;</span> <span class="o">+</span> <span class="n">GREEN</span> <span class="o">+</span> <span class="s1">&#39;7&#39;</span> <span class="o">+</span> <span class="n">RESET</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="n">GREEN</span> <span class="o">+</span> <span class="s1">&#39;7&#39;</span> <span class="o">+</span> <span class="n">RESET</span> <span class="o">+</span> <span class="s1">&#39;))&#39;</span><span class="p">)</span>
    <span class="n">write_button</span><span class="o">.</span><span class="n">on_click</span><span class="p">(</span><span class="n">on_write_button</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

